{"version":3,"file":"cover-axios.min.js","mappings":"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","sources":["webpack://CoverAxios/webpack/universalModuleDefinition","webpack://CoverAxios/external umd \"axios\"","webpack://CoverAxios/webpack/bootstrap","webpack://CoverAxios/webpack/runtime/compat get default export","webpack://CoverAxios/webpack/runtime/define property getters","webpack://CoverAxios/webpack/runtime/hasOwnProperty shorthand","webpack://CoverAxios/webpack/runtime/make namespace object","webpack://CoverAxios/./src/utils/path.ts","webpack://CoverAxios/./src/cover-axios.ts","webpack://CoverAxios/./src/utils/api.ts","webpack://CoverAxios/./src/index.ts","webpack://CoverAxios/./src/version.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"axios\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"axios\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"CoverAxios\"] = factory(require(\"axios\"));\n\telse\n\t\troot[\"CoverAxios\"] = factory(root[\"axios\"]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE__300__) {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__300__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { Api } from 'types'\r\n\r\nexport function cleanPath(path: string) {\r\n\treturn path.replace(/\\/\\//g, '/')\r\n}\r\n\r\n// 添加所有 [:param] 参数数据进url 中\r\nexport function addParamToUrl(api: Api, paramsData: string[]) {\r\n\tconst apiData: Api = JSON.parse(JSON.stringify(api))\r\n\tconst { params } = apiData\r\n\r\n\tif (!params || !paramsData) return apiData\r\n\r\n\tif (paramsData.length !== params.length) {\r\n\t\tthrow new Error(`Bad request parameter. Please check it`)\r\n\t}\r\n\r\n\tfor (var k in params) {\r\n\t\tapiData.url = apiData.url.replace(params[k], paramsData[k])\r\n\t}\r\n\r\n\treturn apiData\r\n}\r\n","import { HttpOptions, Api } from '../types'\r\nimport axios from 'axios'\r\nimport { cleanPath, addParamToUrl } from './utils/path'\r\nimport { version } from './version'\r\n\r\nconst headers = ((): Record<string, string> => {\r\n\tconst _h = localStorage.getItem('requestHeadersCache')\r\n\ttry {\r\n\t\treturn _h ? JSON.parse(_h) : {}\r\n\t} catch (error) {\r\n\t\treturn {}\r\n\t}\r\n})()\r\n\r\nconst options = {\r\n\ttimeout: 2500,\r\n\tbaseURL: '/',\r\n}\r\n\r\nconst instance = axios.create() // 初始化\r\nconst interceptors = instance.interceptors\r\nlet beforeRequestFn: (api: Api) => boolean\r\n\r\nexport const setOptions = (opts: Partial<HttpOptions> = {}) => {\r\n\tinstance.defaults.timeout = options.timeout = opts.timeout || 2500\r\n\tinstance.defaults.baseURL = options.baseURL = opts.baseURL || '/'\r\n\treturn options\r\n}\r\n\r\n// 请求前验证\r\nexport const setBeforeRequest = (fn: (api: Api) => boolean) => {\r\n\tbeforeRequestFn = fn\r\n}\r\n\r\n// 获取当前存储的请求头\r\nexport const getHeaders = () => headers\r\n// 设置请求头\r\nexport const setHeaders = (key: string, value: string) => {\r\n\tif (!key || !value) return\r\n\theaders[key] = value\r\n\tlocalStorage.setItem('requestHeadersCache', JSON.stringify(headers))\r\n\treturn headers\r\n}\r\n\r\n// 移除请求头\r\nexport const removeHeaders = (key: string) => {\r\n\tif (!key) return\r\n\tdelete headers[key]\r\n\tlocalStorage.setItem('requestHeadersCache', JSON.stringify(headers))\r\n\treturn headers\r\n}\r\n\r\n/**\r\n * 批量添加接口定义\r\n * @param apiList\r\n */\r\nexport const addApiList = (apiList: Api[]) => {\r\n\tfor (let v of apiList) {\r\n\t\taddApi(v)\r\n\t}\r\n}\r\nexport const apiMap: Record<string, Api> = {}\r\n/**\r\n * 添加单个接口\r\n * @param api\r\n */\r\nexport const addApi = (api: Api) => {\r\n\tapiMap[api.apiName] = api\r\n}\r\n\r\n/**\r\n * 获取api\r\n * @param {String} apiName\r\n */\r\nexport const getApi = (apiName: string) => {\r\n\treturn apiMap[apiName]\r\n}\r\n\r\nexport const request = (apiName = '', data = {}, param = []) => {\r\n\tlet api = getApi(apiName)\r\n\tif (!api) return Promise.reject(new Error(`\"(${apiName}\": The API does not exist`))\r\n\r\n\tconst { url, method } = addParamToUrl(api, param)\r\n\r\n\tconst pass = beforeRequestFn ? beforeRequestFn(api) : true\r\n\r\n\tif (pass === false) return Promise.reject(`Request validation was't passed`)\r\n\r\n\treturn instance.request({\r\n\t\turl: cleanPath(url),\r\n\t\tmethod,\r\n\t\theaders,\r\n\t\tdata,\r\n\t\tparams: api.method && api.method === 'GET' ? data : undefined,\r\n\t})\r\n}\r\n\r\nconst Http = {\r\n\tsetOptions,\r\n\tsetBeforeRequest,\r\n\tsetHeaders,\r\n\tgetHeaders,\r\n\tremoveHeaders,\r\n\tgetApi,\r\n\taddApi,\r\n\taddApiList,\r\n\trequest,\r\n\tinterceptors,\r\n\tversion,\r\n}\r\n\r\nexport default Http\r\n","import CoverAxios, { Method } from '../../types'\r\nimport { cleanPath } from './path'\r\n\r\n/**\r\n * 添加api接口\r\n * @param apiName \t接口名称\r\n * @param url \t\t接口地址\r\n * @param method \t请求方式\r\n * @param meta\t\t可存储任意数据供开发时使用\r\n */\r\nexport function genApi(apiName: string, url: string, method: Method = 'GET', meta: string): CoverAxios.Api {\r\n\tconst api: CoverAxios.Api = {\r\n\t\tapiName,\r\n\t\tmethod,\r\n\t\turl: cleanPath('/' + url),\r\n\t}\r\n\r\n\tconst params = url.match(/:\\w+/g) // 查找URL中的 [:param]\r\n\r\n\tif (params) {\r\n\t\tapi.params = params\r\n\t}\r\n\r\n\tif (meta) {\r\n\t\tapi.meta = meta\r\n\t}\r\n\r\n\treturn api\r\n}\r\n","import CoverAxios from './cover-axios'\r\nexport * from './cover-axios'\r\nexport * from './utils/api'\r\nexport * from './utils/path'\r\n\r\nexport default CoverAxios\r\n","export const version = '0.3.0'"],"names":["root","factory","exports","module","require","define","amd","self","__WEBPACK_EXTERNAL_MODULE__300__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","cleanPath","path","replace","addParamToUrl","api","paramsData","apiData","JSON","parse","stringify","params","length","Error","k","url","beforeRequestFn","headers","_h","localStorage","getItem","error","options","timeout","baseURL","instance","axios","interceptors","setOptions","opts","defaults","setBeforeRequest","fn","getHeaders","setHeaders","setItem","removeHeaders","addApiList","apiList","v","addApi","apiMap","apiName","getApi","request","data","param","Promise","reject","method","pass","genApi","meta","match","version"],"sourceRoot":""}