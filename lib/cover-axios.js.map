{"version":3,"file":"cover-axios.js","mappings":"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","sources":["webpack://CoverAxios/webpack/universalModuleDefinition","webpack://CoverAxios/./src/cover-axios.ts","webpack://CoverAxios/./src/utils/api.ts","webpack://CoverAxios/./src/utils/path.ts","webpack://CoverAxios/./src/version.ts","webpack://CoverAxios/external umd \"axios\"","webpack://CoverAxios/webpack/bootstrap","webpack://CoverAxios/webpack/runtime/compat get default export","webpack://CoverAxios/webpack/runtime/define property getters","webpack://CoverAxios/webpack/runtime/hasOwnProperty shorthand","webpack://CoverAxios/webpack/runtime/make namespace object","webpack://CoverAxios/./src/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"axios\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"axios\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"CoverAxios\"] = factory(require(\"axios\"));\n\telse\n\t\troot[\"CoverAxios\"] = factory(root[\"axios\"]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE_axios__) {\nreturn ","import { HttpOptions, Api } from '../types'\r\nimport axios from 'axios'\r\nimport { cleanPath, addParamToUrl } from './utils/path'\r\nimport { version } from './version'\r\n\r\nconst headers = ((): Record<string, string> => {\r\n\tconst _h = localStorage.getItem('requestHeadersCache')\r\n\ttry {\r\n\t\treturn _h ? JSON.parse(_h) : {}\r\n\t} catch (error) {\r\n\t\treturn {}\r\n\t}\r\n})()\r\n\r\nconst options = {\r\n\ttimeout: 2500,\r\n\tbaseURL: '/',\r\n}\r\n\r\nconst instance = axios.create() // 初始化\r\nconst interceptors = instance.interceptors\r\nlet beforeRequestFn: (api: Api) => boolean\r\n\r\nexport const setOptions = (opts: Partial<HttpOptions> = {}) => {\r\n\tinstance.defaults.timeout = options.timeout = opts.timeout || 2500\r\n\tinstance.defaults.baseURL = options.baseURL = opts.baseURL || '/'\r\n\treturn options\r\n}\r\n\r\n// 请求前验证\r\nexport const setBeforeRequest = (fn: (api: Api) => boolean) => {\r\n\tbeforeRequestFn = fn\r\n}\r\n\r\n// 获取当前存储的请求头\r\nexport const getHeaders = () => headers\r\n// 设置请求头\r\nexport const setHeaders = (key: string, value: string) => {\r\n\tif (!key || !value) return\r\n\theaders[key] = value\r\n\tlocalStorage.setItem('requestHeadersCache', JSON.stringify(headers))\r\n\treturn headers\r\n}\r\n\r\n// 移除请求头\r\nexport const removeHeaders = (key: string) => {\r\n\tif (!key) return\r\n\tdelete headers[key]\r\n\tlocalStorage.setItem('requestHeadersCache', JSON.stringify(headers))\r\n\treturn headers\r\n}\r\n\r\n/**\r\n * 批量添加接口定义\r\n * @param apiList\r\n */\r\nexport const addApiList = (apiList: Api[]) => {\r\n\tfor (let v of apiList) {\r\n\t\taddApi(v)\r\n\t}\r\n}\r\nexport const apiMap: Record<string, Api> = {}\r\n/**\r\n * 添加单个接口\r\n * @param api\r\n */\r\nexport const addApi = (api: Api) => {\r\n\tapiMap[api.apiName] = api\r\n}\r\n\r\n/**\r\n * 获取api\r\n * @param {String} apiName\r\n */\r\nexport const getApi = (apiName: string) => {\r\n\treturn apiMap[apiName]\r\n}\r\n\r\nexport const request = (apiName = '', data = {}, param = []) => {\r\n\tlet api = getApi(apiName)\r\n\tif (!api) return Promise.reject(new Error(`\"(${apiName}\": The API does not exist`))\r\n\r\n\tconst { url, method } = addParamToUrl(api, param)\r\n\r\n\tconst pass = beforeRequestFn ? beforeRequestFn(api) : true\r\n\r\n\tif (pass === false) return Promise.reject(`Request validation was't passed`)\r\n\r\n\treturn instance.request({\r\n\t\turl: cleanPath(url),\r\n\t\tmethod,\r\n\t\theaders,\r\n\t\tdata,\r\n\t\tparams: api.method && api.method === 'GET' ? data : undefined,\r\n\t})\r\n}\r\n\r\nconst Http = {\r\n\tsetOptions,\r\n\tsetBeforeRequest,\r\n\tsetHeaders,\r\n\tgetHeaders,\r\n\tremoveHeaders,\r\n\tgetApi,\r\n\taddApi,\r\n\taddApiList,\r\n\trequest,\r\n\tinterceptors,\r\n\tversion,\r\n}\r\n\r\nexport default Http\r\n","import CoverAxios, { Method } from '../../types'\r\nimport { cleanPath } from './path'\r\n\r\n/**\r\n * 添加api接口\r\n * @param apiName \t接口名称\r\n * @param url \t\t接口地址\r\n * @param method \t请求方式\r\n * @param meta\t\t可存储任意数据供开发时使用\r\n */\r\nexport function genApi(apiName: string, url: string, method: Method = 'GET', meta: string): CoverAxios.Api {\r\n\tconst api: CoverAxios.Api = {\r\n\t\tapiName,\r\n\t\tmethod,\r\n\t\turl: cleanPath('/' + url),\r\n\t}\r\n\r\n\tconst params = url.match(/:\\w+/g) // 查找URL中的 [:param]\r\n\r\n\tif (params) {\r\n\t\tapi.params = params\r\n\t}\r\n\r\n\tif (meta) {\r\n\t\tapi.meta = meta\r\n\t}\r\n\r\n\treturn api\r\n}\r\n","import { Api } from 'types'\r\n\r\nexport function cleanPath(path: string) {\r\n\treturn path.replace(/\\/\\//g, '/')\r\n}\r\n\r\n// 添加所有 [:param] 参数数据进url 中\r\nexport function addParamToUrl(api: Api, paramsData: string[]) {\r\n\tconst apiData: Api = JSON.parse(JSON.stringify(api))\r\n\tconst { params } = apiData\r\n\r\n\tif (!params || !paramsData) return apiData\r\n\r\n\tif (paramsData.length !== params.length) {\r\n\t\tthrow new Error(`Bad request parameter. Please check it`)\r\n\t}\r\n\r\n\tfor (var k in params) {\r\n\t\tapiData.url = apiData.url.replace(params[k], paramsData[k])\r\n\t}\r\n\r\n\treturn apiData\r\n}\r\n","export const version = '0.3.0'","module.exports = __WEBPACK_EXTERNAL_MODULE_axios__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import CoverAxios from './cover-axios'\r\nexport * from './cover-axios'\r\nexport * from './utils/api'\r\nexport * from './utils/path'\r\n\r\nexport default CoverAxios\r\n"],"names":["axios","cleanPath","addParamToUrl","version","headers","_h","localStorage","getItem","JSON","parse","error","options","timeout","baseURL","instance","create","interceptors","beforeRequestFn","setOptions","opts","defaults","setBeforeRequest","fn","getHeaders","setHeaders","key","value","setItem","stringify","removeHeaders","addApiList","apiList","v","addApi","apiMap","api","apiName","getApi","request","data","param","Promise","reject","Error","url","method","pass","params","undefined","Http","genApi","meta","match","path","replace","paramsData","apiData","length","k","CoverAxios"],"sourceRoot":""}